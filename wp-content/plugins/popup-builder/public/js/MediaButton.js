function SGPBMediaButton(){}SGPBMediaButton.prototype.init=function(){this.tinymceButton(),this.openMediaButtonPopup()},SGPBMediaButton.prototype.tinymceButton=function(){var n=this;jQuery(document).on("tinymce-editor-setup",function(e,t){-1===t.settings.toolbar1.indexOf("popupBuilderEditorButton")&&(t.settings.toolbar1+=", popupBuilderEditorButton",t.addButton("popupBuilderEditorButton",{icon:"wp-menu-image dashicons-before dashicons-menu-icon-sgpb sgpb-tinymce-button",onclick:function(){n.mediaButtonPopup()}}))})},SGPBMediaButton.prototype.openMediaButtonPopup=function(){var t=this;jQuery(".sgpb-tinymce-button, .sgpb-insert-media-button-js, .sgpb-insert-js-variable").unbind("click").bind("click",function(e){e.preventDefault(),t.mediaButtonPopup(jQuery(this))})},SGPBMediaButton.prototype.mediaButtonPopup=function(e){var t=1,n=this,o=jQuery(e).attr("data-id")||"sgpb-hidden-media-popup",i=new PopupConfig;i.magicCall("setContentPadding",14),i.magicCall("setContentBorderRadius",4),i.magicCall("setContentBorderRadiusType","px"),i.magicCall("setContentBorderWidth",5),i.magicCall("setContentBorderColor","#506274"),i.magicCall("setShadowSpread",1),i.magicCall("setContentShadowBlur",4),i.magicCall("setContentShadowColor","#cccccc"),i.magicCall("setMinWidth",400),i.magicCall("setSrcElement",o),i.magicCall("setOverlayColor","black"),i.magicCall("setOverlayOpacity",40);var a=i.combineConfigObj(),r=new SGPopup(a);r.open(),jQuery(window).bind("sgpbDidOpen",function(){jQuery(".sgpb-insert-popup").addClass("js-sg-select2"),mediaButtonParams.currentPostType!==mediaButtonParams.popupBuilderPostType?(jQuery(".sgpb-insert-popup-event").addClass("js-sg-select2"),1===t&&n.popupSelect2(),t++,jQuery(".select2-container--below").remove(),n.popupSelect2()):(n.popupSelect2(),jQuery(".select2-container--below").remove()),n.closeMediaButtonPopup(r)}),n.insertPopup(r)},SGPBMediaButton.prototype.closeMediaButtonPopup=function(e){jQuery(".sgpb-close-media-popup-js").on("click",function(){e.close()})},SGPBMediaButton.prototype.insertPopup=function(r){var s=!1;mediaButtonParams.currentPostType===mediaButtonParams.popupBuilderPostType&&(s=!0),jQuery(".sgpb-insert-popup-js").unbind("click").bind("click",function(){var e,t,n,o="",i=jQuery(".sgpb-insert-popup").val(),a=void 0!==(a=jQuery(".sgpb-insert-popup-event").val())?' event="'+a+'"':s?' insidePopup="on"':"";if(""!==i&&null!==i){if("onLoad"===a&&!s)return window.send_to_editor('[sg_popup id="'+i+'"'+a+"][/sg_popup]"),void r.close();void 0!==tinyMCE.editors.content&&null===document.getElementById("content").offsetParent?o=tinyMCE.activeEditor.selection.getContent()?tinyMCE.activeEditor.selection.getContent():"":(e=document.getElementById("content"),void 0!==document.selection?(e.focus(),o=document.selection.createRange().text):null!=e&&void 0!==e.selectionStart&&(t=e.selectionStart,n=e.selectionEnd,o=e.value.substring(t,n))),window.send_to_editor('[sg_popup id="'+i+'"'+a+"]"+o+"[/sg_popup]"),r.close()}else r.close()}),jQuery(".sgpb-insert-js-variable-to-editor").unbind("click").bind("click",function(){var e=jQuery(".sgpb-popup-dialog-main-div-wrapper .sgpb-js-variable-selector").val(),t=jQuery(".sgpb-popup-dialog-main-div-wrapper .sgpb-js-variable-attribute").val();jQuery(".sgpb-js-variable-errors").addClass("sg-hide-element");var n=!0;if(""===e&&(n=!1,jQuery(".sgpb-js-variable-selector-error").removeClass("sg-hide-element")),""===t&&(n=!1,jQuery(".sgpb-js-variable-attribute-error").removeClass("sg-hide-element")),!n)return!1;jQuery(".sgpb-js-variable-errors").addClass("sg-hide-element"),window.send_to_editor('[pbvariable selector="'+e+'" attribute="'+t+'"]'),r.close()})},SGPBMediaButton.prototype.popupSelect2=function(){jQuery(".js-sg-select2").length&&jQuery("select.js-sg-select2").each(function(){var e=jQuery(this).attr("data-select-type"),t=(jQuery(this).attr("data-select-class"),{width:"100%"});if("ajax"===e){if("undefined"==typeof SGPB_JS_PARAMS)return;t=jQuery.extend(t,{minimumInputLength:1,ajax:{url:SGPB_JS_PARAMS.url,dataType:"json",delay:250,type:"POST",data:function(e){var t=jQuery(this).attr("data-value-param");return{action:"select2_search_data",nonce_ajax:SGPB_JS_PARAMS.nonce,searchTerm:e.term,searchKey:t}},processResults:function(e){return{results:jQuery.map(e.items,function(e){return{text:e.text,id:e.id}})}}}})}jQuery(this).sgpbselect2(t)})},jQuery(document).ready(function(){var n=new SGPBMediaButton;jQuery(document).on("tinymce-editor-init",function(e,t){n.init()})});